# Домашнее задание по лекции "5.2. Применение принципов IaaC в работе с виртуальными машинами"

## Обязательная задача 1

- Опишите своими словами основные преимущества применения на практике IaaC паттернов.
- Какой из принципов IaaC является основополагающим?

**Ответ**:

Программные комплексы IaaC позволяют существенно сократить по времени цикл разработки ПО ускоряя процессы тестирования за счёт автоматизации разворачивания тестовых сред и доставки туда новых версий (**CI/CD**). Например, разработчики заливают очередное обновление в систему контроля версий, которая самостоятельно подготавливает сборку для тестирования. Средствами IaaC могут автоматически создаваться тестовые среды в необходимом количестве (допустим для разных операционных систем) и заливаться туда нужные сборки. После выполнения тестирования среды могут уничтожаться. Аналогично, после тестирования при слиянии веток в основную (**master**) гипотетически может осуществляться автоматическое разворачиваение новой версии (**Continuous Deployment**). Подход "инфраструктура как код" также может существенно упростить масштабирование имеющейся инфраструктуры, например, грубо говоря, по скрипту автоматически создать дополнительные сервера с нужными ресурсами и развёрнутом в них ПО.

Основополгающий принцип **IaaS** - `идемпотентность`, благодаря которому при неизменности входных данных (набора команд, скриптов) гарантируется неизменность выходных (результата выполнения набора команд, скриптов). То есть при многократной выполнении одного и того же кода результат его выполнения не меняется.

---

## Обязательная задача 2

- Чем Ansible выгодно отличается от других систем управление конфигурациями?
- Какой, на ваш взгляд, метод работы систем конфигурации более надёжный push или pull?

**Ответ**:

Основное преимущество `Ansible` - независимость от интеграционных компонентов. Для работы Ansible достаточно существующей в управляемой среде SSH инфраструктуры, когда для других аналогичных программы требуется предварительная установка в управляемую среду своих интеграционных модулей (настройка PKI окружения).

Более надёжным способом работы кажется `push`, так как при данной схеме имеется только один источник изменений - главный сервер, который может помимо отправки изменений на управляемые среды вести учёт обновлений (кто получил обновление, а кто по каким-то причинал нет). При работе по схеме `pull` инициатором изменений являются сами управляемые среды, которые гипотетически могут потерять связь с главным сервером и на какое-то время остаться без обновлений, а при восстановлении связи попытаться получить последние изменения без предыдущих, что может привести к ошибкам. И при этом нет централизованой информации о статусе обновлений как может быть в случае **push**.

---

## Обязательная задача 3

Установить на личный компьютер:

- VirtualBox
- Vagrant
- Ansible

Установка VirtualBox в Debian 11

```console
sa@debian:~$ echo "deb [arch=amd64] https://download.virtualbox.org/virtualbox/debian bullseye contrib" | sudo tee -a /etc/apt/sources.list
deb [arch=amd64] https://download.virtualbox.org/virtualbox/debian bullseye contrib
sa@debian:~$ wget -q https://www.virtualbox.org/download/oracle_vbox_2016.asc -O- | sudo apt-key add -
Warning: apt-key is deprecated. Manage keyring files in trusted.gpg.d instead (see apt-key(8)).
OK
sa@debian:~$ sudo apt-get update
Сущ:1 http://security.debian.org bullseye-security InRelease
Сущ:2 http://ftp.ru.debian.org/debian bullseye InRelease
Сущ:3 http://ftp.ru.debian.org/debian bullseye-updates InRelease
Пол:4 https://download.virtualbox.org/virtualbox/debian bullseye InRelease [7 735 B]
Пол:5 https://download.virtualbox.org/virtualbox/debian bullseye/contrib amd64 Packages [1 079 B]
Получено 8 814 B за 6с (1 396 B/s)
Чтение списков пакетов… Готово
sa@debian:~$ sudo apt-get install -y virtualbox-6.1
Чтение списков пакетов… Готово
Построение дерева зависимостей… Готово
Чтение информации о состоянии… Готово
Будут установлены следующие дополнительные пакеты:
  binutils binutils-common binutils-x86-64-linux-gnu gcc gcc-10 libasan6 libbinutils libc-dev-bin libc-devtools
  libc6-dev libcc1-0 libcrypt-dev libctf-nobfd0 libctf0 libdouble-conversion3 libgcc-10-dev libitm1 liblsan0 libmd4c0
  libnsl-dev libpcre2-16-0 libqt5core5a libqt5dbus5 libqt5gui5 libqt5network5 libqt5opengl5 libqt5printsupport5
  libqt5svg5 libqt5widgets5 libqt5x11extras5 libsdl-ttf2.0-0 libsdl1.2debian libtirpc-dev libtsan0 libubsan1
  libxcb-xinerama0 libxcb-xinput0 linux-compiler-gcc-10-x86 linux-headers-5.10.0-13-amd64
  linux-headers-5.10.0-13-common linux-headers-amd64 linux-kbuild-5.10 linux-libc-dev make manpages-dev
  qt5-gtk-platformtheme qttranslations5-l10n
Предлагаемые пакеты:
  binutils-doc gcc-multilib autoconf automake libtool flex bison gdb gcc-doc gcc-10-multilib gcc-10-doc gcc-10-locales
  glibc-doc qt5-image-formats-plugins qtwayland5 make-doc
Рекомендуемые пакеты:
  linux-image
Следующие НОВЫЕ пакеты будут установлены:
  binutils binutils-common binutils-x86-64-linux-gnu gcc gcc-10 libasan6 libbinutils libc-dev-bin libc-devtools
  libc6-dev libcc1-0 libcrypt-dev libctf-nobfd0 libctf0 libdouble-conversion3 libgcc-10-dev libitm1 liblsan0 libmd4c0
  libnsl-dev libpcre2-16-0 libqt5core5a libqt5dbus5 libqt5gui5 libqt5network5 libqt5opengl5 libqt5printsupport5
  libqt5svg5 libqt5widgets5 libqt5x11extras5 libsdl-ttf2.0-0 libsdl1.2debian libtirpc-dev libtsan0 libubsan1
  libxcb-xinerama0 libxcb-xinput0 linux-compiler-gcc-10-x86 linux-headers-5.10.0-13-amd64
  linux-headers-5.10.0-13-common linux-headers-amd64 linux-kbuild-5.10 linux-libc-dev make manpages-dev
  qt5-gtk-platformtheme qttranslations5-l10n virtualbox-6.1
Обновлено 0 пакетов, установлено 48 новых пакетов, для удаления отмечено 0 пакетов, и 0 пакетов не обновлено.
Необходимо скачать 153 MB архивов.
После данной операции объём занятого дискового пространства возрастёт на 467 MB.
Пол:1 http://ftp.ru.debian.org/debian bullseye/main amd64 libdouble-conversion3 amd64 3.1.5-6.1 [41,0 kB]
Пол:2 http://ftp.ru.debian.org/debian bullseye/main amd64 libpcre2-16-0 amd64 10.36-2 [231 kB]
Пол:3 https://download.virtualbox.org/virtualbox/debian bullseye/contrib amd64 virtualbox-6.1 amd64 6.1.34-150636.1~Debian~bullseye [93,6 MB]
Пол:4 http://ftp.ru.debian.org/debian bullseye/main amd64 libqt5core5a amd64 5.15.2+dfsg-9 [1 822 kB]
Пол:5 http://ftp.ru.debian.org/debian bullseye/main amd64 libmd4c0 amd64 0.4.7-2 [43,6 kB]
Пол:6 http://ftp.ru.debian.org/debian bullseye/main amd64 libqt5dbus5 amd64 5.15.2+dfsg-9 [228 kB]
Пол:7 http://ftp.ru.debian.org/debian bullseye/main amd64 libqt5network5 amd64 5.15.2+dfsg-9 [658 kB]
Пол:8 http://ftp.ru.debian.org/debian bullseye/main amd64 libxcb-xinerama0 amd64 1.14-3 [101 kB]
Пол:9 http://ftp.ru.debian.org/debian bullseye/main amd64 libxcb-xinput0 amd64 1.14-3 [126 kB]
Пол:10 http://ftp.ru.debian.org/debian bullseye/main amd64 libqt5gui5 amd64 5.15.2+dfsg-9 [3 320 kB]
Пол:11 http://ftp.ru.debian.org/debian bullseye/main amd64 libqt5widgets5 amd64 5.15.2+dfsg-9 [2 349 kB]
Пол:12 http://ftp.ru.debian.org/debian bullseye/main amd64 libqt5svg5 amd64 5.15.2-3 [132 kB]
Пол:13 http://ftp.ru.debian.org/debian bullseye/main amd64 libqt5opengl5 amd64 5.15.2+dfsg-9 [175 kB]
Пол:14 http://ftp.ru.debian.org/debian bullseye/main amd64 libqt5printsupport5 amd64 5.15.2+dfsg-9 [222 kB]
Пол:15 http://ftp.ru.debian.org/debian bullseye/main amd64 libqt5x11extras5 amd64 5.15.2-2 [12,4 kB]
Пол:16 http://ftp.ru.debian.org/debian bullseye/main amd64 libsdl1.2debian amd64 1.2.15+dfsg2-6 [195 kB]
Пол:17 http://ftp.ru.debian.org/debian bullseye/main amd64 binutils-common amd64 2.35.2-2 [2 220 kB]
Пол:18 http://ftp.ru.debian.org/debian bullseye/main amd64 libbinutils amd64 2.35.2-2 [570 kB]
Пол:19 http://ftp.ru.debian.org/debian bullseye/main amd64 libctf-nobfd0 amd64 2.35.2-2 [110 kB]
Пол:20 http://ftp.ru.debian.org/debian bullseye/main amd64 libctf0 amd64 2.35.2-2 [53,2 kB]
Пол:21 http://ftp.ru.debian.org/debian bullseye/main amd64 binutils-x86-64-linux-gnu amd64 2.35.2-2 [1 809 kB]
Пол:22 http://ftp.ru.debian.org/debian bullseye/main amd64 binutils amd64 2.35.2-2 [61,2 kB]
Пол:23 http://ftp.ru.debian.org/debian bullseye/main amd64 libcc1-0 amd64 10.2.1-6 [47,0 kB]
Пол:24 http://ftp.ru.debian.org/debian bullseye/main amd64 libitm1 amd64 10.2.1-6 [25,8 kB]
Пол:25 http://ftp.ru.debian.org/debian bullseye/main amd64 libasan6 amd64 10.2.1-6 [2 065 kB]
Пол:26 http://ftp.ru.debian.org/debian bullseye/main amd64 liblsan0 amd64 10.2.1-6 [828 kB]
Пол:27 http://ftp.ru.debian.org/debian bullseye/main amd64 libtsan0 amd64 10.2.1-6 [2 000 kB]
Пол:28 http://ftp.ru.debian.org/debian bullseye/main amd64 libubsan1 amd64 10.2.1-6 [777 kB]
Пол:29 http://ftp.ru.debian.org/debian bullseye/main amd64 libgcc-10-dev amd64 10.2.1-6 [2 328 kB]
Пол:30 http://ftp.ru.debian.org/debian bullseye/main amd64 gcc-10 amd64 10.2.1-6 [17,0 MB]
Пол:31 http://ftp.ru.debian.org/debian bullseye/main amd64 gcc amd64 4:10.2.1-1 [5 192 B]
Пол:32 http://ftp.ru.debian.org/debian bullseye/main amd64 libc-dev-bin amd64 2.31-13+deb11u3 [275 kB]
Пол:33 http://ftp.ru.debian.org/debian bullseye/main amd64 libc-devtools amd64 2.31-13+deb11u3 [245 kB]
Пол:34 http://ftp.ru.debian.org/debian bullseye/main amd64 linux-libc-dev amd64 5.10.106-1 [1 470 kB]
Пол:35 http://ftp.ru.debian.org/debian bullseye/main amd64 libcrypt-dev amd64 1:4.4.18-4 [104 kB]
Пол:36 http://ftp.ru.debian.org/debian bullseye/main amd64 libtirpc-dev amd64 1.3.1-1 [190 kB]
Пол:37 http://ftp.ru.debian.org/debian bullseye/main amd64 libnsl-dev amd64 1.3.0-2 [66,4 kB]
Пол:38 http://ftp.ru.debian.org/debian bullseye/main amd64 libc6-dev amd64 2.31-13+deb11u3 [2 348 kB]
Пол:39 http://ftp.ru.debian.org/debian bullseye/main amd64 libsdl-ttf2.0-0 amd64 2.0.11-6 [18,6 kB]
Пол:40 http://ftp.ru.debian.org/debian bullseye/main amd64 linux-compiler-gcc-10-x86 amd64 5.10.106-1 [439 kB]
Пол:41 http://ftp.ru.debian.org/debian bullseye/main amd64 linux-headers-5.10.0-13-common all 5.10.106-1 [8 947 kB]
Пол:42 http://ftp.ru.debian.org/debian bullseye/main amd64 linux-kbuild-5.10 amd64 5.10.106-1 [681 kB]
Пол:43 http://ftp.ru.debian.org/debian bullseye/main amd64 linux-headers-5.10.0-13-amd64 amd64 5.10.106-1 [961 kB]
Пол:44 http://ftp.ru.debian.org/debian bullseye/main amd64 linux-headers-amd64 amd64 5.10.106-1 [1 180 B]
Пол:45 http://ftp.ru.debian.org/debian bullseye/main amd64 make amd64 4.3-4.1 [396 kB]
Пол:46 http://ftp.ru.debian.org/debian bullseye/main amd64 manpages-dev all 5.10-1 [2 309 kB]
Пол:47 http://ftp.ru.debian.org/debian bullseye/main amd64 qt5-gtk-platformtheme amd64 5.15.2+dfsg-9 [143 kB]
Пол:48 http://ftp.ru.debian.org/debian bullseye/main amd64 qttranslations5-l10n all 5.15.2-2 [1 578 kB]
Получено 153 MB за 4мин 11с (610 kB/s)
Извлекаются шаблоны из пакетов: 100%
Предварительная настройка пакетов …
Выбор ранее не выбранного пакета libdouble-conversion3:amd64.
(Чтение базы данных … на данный момент установлено 140769 файлов и каталогов.)
Подготовка к распаковке …/00-libdouble-conversion3_3.1.5-6.1_amd64.deb …
Распаковывается libdouble-conversion3:amd64 (3.1.5-6.1) …
Выбор ранее не выбранного пакета libpcre2-16-0:amd64.
Подготовка к распаковке …/01-libpcre2-16-0_10.36-2_amd64.deb …
Распаковывается libpcre2-16-0:amd64 (10.36-2) …
Выбор ранее не выбранного пакета libqt5core5a:amd64.
Подготовка к распаковке …/02-libqt5core5a_5.15.2+dfsg-9_amd64.deb …
Распаковывается libqt5core5a:amd64 (5.15.2+dfsg-9) …
Выбор ранее не выбранного пакета libmd4c0:amd64.
Подготовка к распаковке …/03-libmd4c0_0.4.7-2_amd64.deb …
Распаковывается libmd4c0:amd64 (0.4.7-2) …
Выбор ранее не выбранного пакета libqt5dbus5:amd64.
Подготовка к распаковке …/04-libqt5dbus5_5.15.2+dfsg-9_amd64.deb …
Распаковывается libqt5dbus5:amd64 (5.15.2+dfsg-9) …
Выбор ранее не выбранного пакета libqt5network5:amd64.
Подготовка к распаковке …/05-libqt5network5_5.15.2+dfsg-9_amd64.deb …
Распаковывается libqt5network5:amd64 (5.15.2+dfsg-9) …
Выбор ранее не выбранного пакета libxcb-xinerama0:amd64.
Подготовка к распаковке …/06-libxcb-xinerama0_1.14-3_amd64.deb …
Распаковывается libxcb-xinerama0:amd64 (1.14-3) …
Выбор ранее не выбранного пакета libxcb-xinput0:amd64.
Подготовка к распаковке …/07-libxcb-xinput0_1.14-3_amd64.deb …
Распаковывается libxcb-xinput0:amd64 (1.14-3) …
Выбор ранее не выбранного пакета libqt5gui5:amd64.
Подготовка к распаковке …/08-libqt5gui5_5.15.2+dfsg-9_amd64.deb …
Распаковывается libqt5gui5:amd64 (5.15.2+dfsg-9) …
Выбор ранее не выбранного пакета libqt5widgets5:amd64.
Подготовка к распаковке …/09-libqt5widgets5_5.15.2+dfsg-9_amd64.deb …
Распаковывается libqt5widgets5:amd64 (5.15.2+dfsg-9) …
Выбор ранее не выбранного пакета libqt5svg5:amd64.
Подготовка к распаковке …/10-libqt5svg5_5.15.2-3_amd64.deb …
Распаковывается libqt5svg5:amd64 (5.15.2-3) …
Выбор ранее не выбранного пакета libqt5opengl5:amd64.
Подготовка к распаковке …/11-libqt5opengl5_5.15.2+dfsg-9_amd64.deb …
Распаковывается libqt5opengl5:amd64 (5.15.2+dfsg-9) …
Выбор ранее не выбранного пакета libqt5printsupport5:amd64.
Подготовка к распаковке …/12-libqt5printsupport5_5.15.2+dfsg-9_amd64.deb …
Распаковывается libqt5printsupport5:amd64 (5.15.2+dfsg-9) …
Выбор ранее не выбранного пакета libqt5x11extras5:amd64.
Подготовка к распаковке …/13-libqt5x11extras5_5.15.2-2_amd64.deb …
Распаковывается libqt5x11extras5:amd64 (5.15.2-2) …
Выбор ранее не выбранного пакета libsdl1.2debian:amd64.
Подготовка к распаковке …/14-libsdl1.2debian_1.2.15+dfsg2-6_amd64.deb …
Распаковывается libsdl1.2debian:amd64 (1.2.15+dfsg2-6) …
Выбор ранее не выбранного пакета virtualbox-6.1.
Подготовка к распаковке …/15-virtualbox-6.1_6.1.34-150636.1~Debian~bullseye_amd64.deb …
Распаковывается virtualbox-6.1 (6.1.34-150636.1~Debian~bullseye) …
Выбор ранее не выбранного пакета binutils-common:amd64.
Подготовка к распаковке …/16-binutils-common_2.35.2-2_amd64.deb …
Распаковывается binutils-common:amd64 (2.35.2-2) …
Выбор ранее не выбранного пакета libbinutils:amd64.
Подготовка к распаковке …/17-libbinutils_2.35.2-2_amd64.deb …
Распаковывается libbinutils:amd64 (2.35.2-2) …
Выбор ранее не выбранного пакета libctf-nobfd0:amd64.
Подготовка к распаковке …/18-libctf-nobfd0_2.35.2-2_amd64.deb …
Распаковывается libctf-nobfd0:amd64 (2.35.2-2) …
Выбор ранее не выбранного пакета libctf0:amd64.
Подготовка к распаковке …/19-libctf0_2.35.2-2_amd64.deb …
Распаковывается libctf0:amd64 (2.35.2-2) …
Выбор ранее не выбранного пакета binutils-x86-64-linux-gnu.
Подготовка к распаковке …/20-binutils-x86-64-linux-gnu_2.35.2-2_amd64.deb …
Распаковывается binutils-x86-64-linux-gnu (2.35.2-2) …
Выбор ранее не выбранного пакета binutils.
Подготовка к распаковке …/21-binutils_2.35.2-2_amd64.deb …
Распаковывается binutils (2.35.2-2) …
Выбор ранее не выбранного пакета libcc1-0:amd64.
Подготовка к распаковке …/22-libcc1-0_10.2.1-6_amd64.deb …
Распаковывается libcc1-0:amd64 (10.2.1-6) …
Выбор ранее не выбранного пакета libitm1:amd64.
Подготовка к распаковке …/23-libitm1_10.2.1-6_amd64.deb …
Распаковывается libitm1:amd64 (10.2.1-6) …
Выбор ранее не выбранного пакета libasan6:amd64.
Подготовка к распаковке …/24-libasan6_10.2.1-6_amd64.deb …
Распаковывается libasan6:amd64 (10.2.1-6) …
Выбор ранее не выбранного пакета liblsan0:amd64.
Подготовка к распаковке …/25-liblsan0_10.2.1-6_amd64.deb …
Распаковывается liblsan0:amd64 (10.2.1-6) …
Выбор ранее не выбранного пакета libtsan0:amd64.
Подготовка к распаковке …/26-libtsan0_10.2.1-6_amd64.deb …
Распаковывается libtsan0:amd64 (10.2.1-6) …
Выбор ранее не выбранного пакета libubsan1:amd64.
Подготовка к распаковке …/27-libubsan1_10.2.1-6_amd64.deb …
Распаковывается libubsan1:amd64 (10.2.1-6) …
Выбор ранее не выбранного пакета libgcc-10-dev:amd64.
Подготовка к распаковке …/28-libgcc-10-dev_10.2.1-6_amd64.deb …
Распаковывается libgcc-10-dev:amd64 (10.2.1-6) …
Выбор ранее не выбранного пакета gcc-10.
Подготовка к распаковке …/29-gcc-10_10.2.1-6_amd64.deb …
Распаковывается gcc-10 (10.2.1-6) …
Выбор ранее не выбранного пакета gcc.
Подготовка к распаковке …/30-gcc_4%3a10.2.1-1_amd64.deb …
Распаковывается gcc (4:10.2.1-1) …
Выбор ранее не выбранного пакета libc-dev-bin.
Подготовка к распаковке …/31-libc-dev-bin_2.31-13+deb11u3_amd64.deb …
Распаковывается libc-dev-bin (2.31-13+deb11u3) …
Выбор ранее не выбранного пакета libc-devtools.
Подготовка к распаковке …/32-libc-devtools_2.31-13+deb11u3_amd64.deb …
Распаковывается libc-devtools (2.31-13+deb11u3) …
Выбор ранее не выбранного пакета linux-libc-dev:amd64.
Подготовка к распаковке …/33-linux-libc-dev_5.10.106-1_amd64.deb …
Распаковывается linux-libc-dev:amd64 (5.10.106-1) …
Выбор ранее не выбранного пакета libcrypt-dev:amd64.
Подготовка к распаковке …/34-libcrypt-dev_1%3a4.4.18-4_amd64.deb …
Распаковывается libcrypt-dev:amd64 (1:4.4.18-4) …
Выбор ранее не выбранного пакета libtirpc-dev:amd64.
Подготовка к распаковке …/35-libtirpc-dev_1.3.1-1_amd64.deb …
Распаковывается libtirpc-dev:amd64 (1.3.1-1) …
Выбор ранее не выбранного пакета libnsl-dev:amd64.
Подготовка к распаковке …/36-libnsl-dev_1.3.0-2_amd64.deb …
Распаковывается libnsl-dev:amd64 (1.3.0-2) …
Выбор ранее не выбранного пакета libc6-dev:amd64.
Подготовка к распаковке …/37-libc6-dev_2.31-13+deb11u3_amd64.deb …
Распаковывается libc6-dev:amd64 (2.31-13+deb11u3) …
Выбор ранее не выбранного пакета libsdl-ttf2.0-0:amd64.
Подготовка к распаковке …/38-libsdl-ttf2.0-0_2.0.11-6_amd64.deb …
Распаковывается libsdl-ttf2.0-0:amd64 (2.0.11-6) …
Выбор ранее не выбранного пакета linux-compiler-gcc-10-x86.
Подготовка к распаковке …/39-linux-compiler-gcc-10-x86_5.10.106-1_amd64.deb …
Распаковывается linux-compiler-gcc-10-x86 (5.10.106-1) …
Выбор ранее не выбранного пакета linux-headers-5.10.0-13-common.
Подготовка к распаковке …/40-linux-headers-5.10.0-13-common_5.10.106-1_all.deb …
Распаковывается linux-headers-5.10.0-13-common (5.10.106-1) …
Выбор ранее не выбранного пакета linux-kbuild-5.10.
Подготовка к распаковке …/41-linux-kbuild-5.10_5.10.106-1_amd64.deb …
Распаковывается linux-kbuild-5.10 (5.10.106-1) …
Выбор ранее не выбранного пакета linux-headers-5.10.0-13-amd64.
Подготовка к распаковке …/42-linux-headers-5.10.0-13-amd64_5.10.106-1_amd64.deb …
Распаковывается linux-headers-5.10.0-13-amd64 (5.10.106-1) …
Выбор ранее не выбранного пакета linux-headers-amd64.
Подготовка к распаковке …/43-linux-headers-amd64_5.10.106-1_amd64.deb …
Распаковывается linux-headers-amd64 (5.10.106-1) …
Выбор ранее не выбранного пакета make.
Подготовка к распаковке …/44-make_4.3-4.1_amd64.deb …
Распаковывается make (4.3-4.1) …
Выбор ранее не выбранного пакета manpages-dev.
Подготовка к распаковке …/45-manpages-dev_5.10-1_all.deb …
Распаковывается manpages-dev (5.10-1) …
Выбор ранее не выбранного пакета qt5-gtk-platformtheme:amd64.
Подготовка к распаковке …/46-qt5-gtk-platformtheme_5.15.2+dfsg-9_amd64.deb …
Распаковывается qt5-gtk-platformtheme:amd64 (5.15.2+dfsg-9) …
Выбор ранее не выбранного пакета qttranslations5-l10n.
Подготовка к распаковке …/47-qttranslations5-l10n_5.15.2-2_all.deb …
Распаковывается qttranslations5-l10n (5.15.2-2) …
Настраивается пакет manpages-dev (5.10-1) …
Настраивается пакет libdouble-conversion3:amd64 (3.1.5-6.1) …
Настраивается пакет libxcb-xinput0:amd64 (1.14-3) …
Настраивается пакет binutils-common:amd64 (2.35.2-2) …
Настраивается пакет linux-libc-dev:amd64 (5.10.106-1) …
Настраивается пакет libctf-nobfd0:amd64 (2.35.2-2) …
Настраивается пакет libpcre2-16-0:amd64 (10.36-2) …
Настраивается пакет libasan6:amd64 (10.2.1-6) …
Настраивается пакет libxcb-xinerama0:amd64 (1.14-3) …
Настраивается пакет libtirpc-dev:amd64 (1.3.1-1) …
Настраивается пакет qttranslations5-l10n (5.15.2-2) …
Настраивается пакет make (4.3-4.1) …
Настраивается пакет libsdl1.2debian:amd64 (1.2.15+dfsg2-6) …
Настраивается пакет libqt5core5a:amd64 (5.15.2+dfsg-9) …
Настраивается пакет libubsan1:amd64 (10.2.1-6) …
Настраивается пакет libnsl-dev:amd64 (1.3.0-2) …
Настраивается пакет libqt5dbus5:amd64 (5.15.2+dfsg-9) …
Настраивается пакет libcrypt-dev:amd64 (1:4.4.18-4) …
Настраивается пакет linux-kbuild-5.10 (5.10.106-1) …
Настраивается пакет libmd4c0:amd64 (0.4.7-2) …
Настраивается пакет libsdl-ttf2.0-0:amd64 (2.0.11-6) …
Настраивается пакет libbinutils:amd64 (2.35.2-2) …
Настраивается пакет libc-dev-bin (2.31-13+deb11u3) …
Настраивается пакет linux-headers-5.10.0-13-common (5.10.106-1) …
Настраивается пакет libcc1-0:amd64 (10.2.1-6) …
Настраивается пакет liblsan0:amd64 (10.2.1-6) …
Настраивается пакет libitm1:amd64 (10.2.1-6) …
Настраивается пакет libc-devtools (2.31-13+deb11u3) …
Настраивается пакет libtsan0:amd64 (10.2.1-6) …
Настраивается пакет libctf0:amd64 (2.35.2-2) …
Настраивается пакет libgcc-10-dev:amd64 (10.2.1-6) …
Настраивается пакет libqt5network5:amd64 (5.15.2+dfsg-9) …
Настраивается пакет libc6-dev:amd64 (2.31-13+deb11u3) …
Настраивается пакет binutils-x86-64-linux-gnu (2.35.2-2) …
Настраивается пакет libqt5gui5:amd64 (5.15.2+dfsg-9) …
Настраивается пакет libqt5widgets5:amd64 (5.15.2+dfsg-9) …
Настраивается пакет binutils (2.35.2-2) …
Настраивается пакет qt5-gtk-platformtheme:amd64 (5.15.2+dfsg-9) …
Настраивается пакет libqt5printsupport5:amd64 (5.15.2+dfsg-9) …
Настраивается пакет gcc-10 (10.2.1-6) …
Настраивается пакет libqt5opengl5:amd64 (5.15.2+dfsg-9) …
Настраивается пакет linux-compiler-gcc-10-x86 (5.10.106-1) …
Настраивается пакет libqt5x11extras5:amd64 (5.15.2-2) …
Настраивается пакет libqt5svg5:amd64 (5.15.2-3) …
Настраивается пакет gcc (4:10.2.1-1) …
Настраивается пакет virtualbox-6.1 (6.1.34-150636.1~Debian~bullseye) …
Добавляется группа «vboxusers» (GID 125) ...
Готово.
Настраивается пакет linux-headers-5.10.0-13-amd64 (5.10.106-1) …
Настраивается пакет linux-headers-amd64 (5.10.106-1) …
Обрабатываются триггеры для man-db (2.9.4-2) …
Обрабатываются триггеры для shared-mime-info (2.0-1) …
Обрабатываются триггеры для mailcap (3.69) …
Обрабатываются триггеры для desktop-file-utils (0.26-1) …
Обрабатываются триггеры для hicolor-icon-theme (0.17-2) …
Обрабатываются триггеры для gnome-menus (3.36.0-1) …
Обрабатываются триггеры для libc-bin (2.31-13+deb11u3) …
sa@debian:~$
```

Установка Ansible в Debian 11

```console
sa@debian:~$ echo "deb http://ppa.launchpad.net/ansible/ansible/ubuntu focal main" | sudo tee -a /etc/apt/sources.list
deb http://ppa.launchpad.net/ansible/ansible/ubuntu focal main
sa@debian:~$ sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 93C4A3FD7BB9C367
Warning: apt-key is deprecated. Manage keyring files in trusted.gpg.d instead (see apt-key(8)).
Executing: /tmp/apt-key-gpghome.2n1QvLavm7/gpg.1.sh --keyserver keyserver.ubuntu.com --recv-keys 93C4A3FD7BB9C367
gpg: ключ 93C4A3FD7BB9C367: импортирован открытый ключ "Launchpad PPA for Ansible, Inc."
gpg: Всего обработано: 1
gpg:                  импортировано: 1
sa@debian:~$ sudo apt update
Сущ:1 http://ftp.ru.debian.org/debian bullseye InRelease
Сущ:2 http://security.debian.org bullseye-security InRelease
Сущ:3 http://ftp.ru.debian.org/debian bullseye-updates InRelease
Пол:4 http://ppa.launchpad.net/ansible/ansible/ubuntu focal InRelease [18,0 kB]
Пол:5 http://ppa.launchpad.net/ansible/ansible/ubuntu focal/main amd64 Packages [1 128 B]
Пол:6 http://ppa.launchpad.net/ansible/ansible/ubuntu focal/main Translation-en [756 B]
Сущ:7 https://download.virtualbox.org/virtualbox/debian bullseye InRelease
Получено 19,9 kB за 1с (19,0 kB/s)
Чтение списков пакетов… Готово
Построение дерева зависимостей… Готово
Чтение информации о состоянии… Готово
Все пакеты имеют последние версии.
sa@debian:~$ sudo apt install -y ansible
Чтение списков пакетов… Готово
Построение дерева зависимостей… Готово
Чтение информации о состоянии… Готово
Будут установлены следующие дополнительные пакеты:
  ansible-core python3-bcrypt python3-cffi-backend python3-cryptography python3-invoke python3-jinja2 python3-jmespath
  python3-kerberos python3-nacl python3-ntlm-auth python3-packaging python3-paramiko python3-pyparsing
  python3-requests-kerberos python3-requests-ntlm python3-resolvelib python3-winrm python3-xmltodict python3-yaml
  sshpass
Предлагаемые пакеты:
  python-cryptography-doc python3-cryptography-vectors python-invoke-doc python-jinja2-doc python-nacl-doc
  python3-gssapi python-pyparsing-doc
Следующие НОВЫЕ пакеты будут установлены:
  ansible ansible-core python3-bcrypt python3-cffi-backend python3-cryptography python3-invoke python3-jinja2
Подготовка к распаковке …/19-python3-winrm_0.3.0-2_all.deb …
Распаковывается python3-winrm (0.3.0-2) …
Выбор ранее не выбранного пакета sshpass.
Подготовка к распаковке …/20-sshpass_1.09-1+b1_amd64.deb …
Распаковывается sshpass (1.09-1+b1) …
Настраивается пакет python3-ntlm-auth (1.4.0-1) …
Настраивается пакет python3-resolvelib (0.5.4-2ppa~focal) …
Настраивается пакет python3-kerberos (1.1.14-3.1+b3) …
Настраивается пакет python3-yaml (5.3.1-5) …
Настраивается пакет sshpass (1.09-1+b1) …
Настраивается пакет python3-xmltodict (0.12.0-2) …
Настраивается пакет python3-jinja2 (2.11.3-1) …
Настраивается пакет python3-pyparsing (2.4.7-1) …
Настраивается пакет python3-jmespath (0.10.0-1) …
Настраивается пакет python3-invoke (1.4.1+ds-0.1) …
Настраивается пакет python3-cffi-backend:amd64 (1.14.5-1) …
Настраивается пакет python3-bcrypt (3.1.7-4) …
Настраивается пакет python3-packaging (20.9-2) …
Настраивается пакет python3-cryptography (3.3.2-1) …
Настраивается пакет python3-requests-kerberos (0.12.0-2) …
Настраивается пакет python3-nacl (1.4.0-1+b1) …
Настраивается пакет python3-requests-ntlm (1.1.0-1.1) …
Настраивается пакет ansible-core (2.12.4-1ppa~focal) …
Настраивается пакет python3-winrm (0.3.0-2) …
Настраивается пакет ansible (5.6.0-1ppa~focal) …
Настраивается пакет python3-paramiko (2.7.2-1) …
Обрабатываются триггеры для man-db (2.9.4-2) …
sa@debian:~$
```

Установка Vagrant в Debian 11

```console
sa@debian:~$ curl -fsSL https://apt.releases.hashicorp.com/gpg | sudo apt-key add -
Warning: apt-key is deprecated. Manage keyring files in trusted.gpg.d instead (see apt-key(8)).
OK
sa@debian:~$ sudo apt-add-repository "deb [arch=amd64] https://apt.releases.hashicorp.com $(lsb_release -cs) main"
sa@debian:~$ sudo apt-get update && sudo apt-get install vagrant
Сущ:1 http://security.debian.org bullseye-security InRelease
Сущ:2 http://ppa.launchpad.net/ansible/ansible/ubuntu focal InRelease
Сущ:3 http://ftp.ru.debian.org/debian bullseye InRelease
Пол:4 https://apt.releases.hashicorp.com bullseye InRelease [11,2 kB]
Сущ:5 http://ftp.ru.debian.org/debian bullseye-updates InRelease
Сущ:6 https://download.virtualbox.org/virtualbox/debian bullseye InRelease
Пол:7 https://apt.releases.hashicorp.com bullseye/main amd64 Packages [51,4 kB]
Получено 62,6 kB за 1с (53,0 kB/s)
Чтение списков пакетов… Готово
Чтение списков пакетов… Готово
Построение дерева зависимостей… Готово
Чтение информации о состоянии… Готово
Следующие НОВЫЕ пакеты будут установлены:
  vagrant
Обновлено 0 пакетов, установлено 1 новых пакетов, для удаления отмечено 0 пакетов, и 0 пакетов не обновлено.
Необходимо скачать 41,5 MB архивов.
После данной операции объём занятого дискового пространства возрастёт на 117 MB.
Пол:1 https://apt.releases.hashicorp.com bullseye/main amd64 vagrant amd64 2.2.19 [41,5 MB]
Получено 41,5 MB за 31с (1 330 kB/s)
Выбор ранее не выбранного пакета vagrant.
(Чтение базы данных … на данный момент установлен 211561 файл и каталог.)
Подготовка к распаковке …/vagrant_2.2.19_amd64.deb …
Распаковывается vagrant (2.2.19) …
Настраивается пакет vagrant (2.2.19) …
sa@debian:~$
```

**Отчёт**:

```console
sa@debian:~$ VBoxManage -v
6.1.34r150636
sa@debian:~$ vagrant -v
Vagrant 2.2.19
sa@debian:~$ ansible --version
ansible [core 2.12.4]
  config file = /etc/ansible/ansible.cfg
  configured module search path = ['/home/sa/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3/dist-packages/ansible
  ansible collection location = /home/sa/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible
  python version = 3.9.2 (default, Feb 28 2021, 17:03:44) [GCC 10.2.1 20210110]
  jinja version = 2.11.3
  libyaml = True
sa@debian:~$
```

---

## Дополнительная задача 4 (*)

Воспроизвести практическую часть лекции самостоятельно.

- Создать виртуальную машину.
- Зайти внутрь ВМ, убедиться, что Docker установлен с помощью команды `docker ps`

Так как необходимые компоненты были установлены в предыдущей задаче остаётся только скопировать дополнительные файлы (содержимое каталога `src`) и запустить машину из каталога `vagrant`. Чтобы не было ошибки в пункте **Ansible** `Adding rsa-key in /root/.ssh/authorized_keys` предварительно нужно создать пару ключей для SSH по алгоритму RSA.

Отчёт:

```console
sa@debian:~/test/vagrant$ sudo vagrant up
Bringing machine 'server1.netology' up with 'virtualbox' provider...
==> server1.netology: Importing base box 'bento/ubuntu-20.04'...
==> server1.netology: Matching MAC address for NAT networking...
==> server1.netology: Checking if box 'bento/ubuntu-20.04' version '202112.19.0' is up to date...
==> server1.netology: Setting the name of the VM: server1.netology
==> server1.netology: Clearing any previously set network interfaces...
==> server1.netology: Preparing network interfaces based on configuration...
    server1.netology: Adapter 1: nat
    server1.netology: Adapter 2: hostonly
==> server1.netology: Forwarding ports...
    server1.netology: 22 (guest) => 20011 (host) (adapter 1)
    server1.netology: 22 (guest) => 2222 (host) (adapter 1)
==> server1.netology: Running 'pre-boot' VM customizations...
==> server1.netology: Booting VM...
==> server1.netology: Waiting for machine to boot. This may take a few minutes...
    server1.netology: SSH address: 127.0.0.1:2222
    server1.netology: SSH username: vagrant
    server1.netology: SSH auth method: private key
    server1.netology: Warning: Connection reset. Retrying...
    server1.netology: 
    server1.netology: Vagrant insecure key detected. Vagrant will automatically replace
    server1.netology: this with a newly generated keypair for better security.
    server1.netology: 
    server1.netology: Inserting generated public key within guest...
    server1.netology: Removing insecure key from the guest if it's present...
    server1.netology: Key inserted! Disconnecting and reconnecting using new SSH key...
==> server1.netology: Machine booted and ready!
==> server1.netology: Checking for guest additions in VM...
==> server1.netology: Setting hostname...
==> server1.netology: Configuring and enabling network interfaces...
==> server1.netology: Mounting shared folders...
    server1.netology: /vagrant => /home/sa/test/vagrant
==> server1.netology: Running provisioner: ansible...
    server1.netology: Running ansible-playbook...

PLAY [nodes] *******************************************************************

TASK [Gathering Facts] *********************************************************
ok: [server1.netology]

TASK [Create directory for ssh-keys] *******************************************
ok: [server1.netology]

TASK [Adding rsa-key in /root/.ssh/authorized_keys] ****************************
changed: [server1.netology]

TASK [Checking DNS] ************************************************************
changed: [server1.netology]

TASK [Installing tools] ********************************************************
ok: [server1.netology] => (item=git)
ok: [server1.netology] => (item=curl)

TASK [Installing docker] *******************************************************
changed: [server1.netology]

TASK [Add the current user to docker group] ************************************
changed: [server1.netology]

PLAY RECAP *********************************************************************
server1.netology           : ok=7    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

sa@debian:~/test/vagrant$ sudo vagrant ssh
Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-91-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Fri 22 Apr 2022 02:14:48 PM UTC

  System load:  0.45               Users logged in:          0
  Usage of /:   13.4% of 30.88GB   IPv4 address for docker0: 172.17.0.1
  Memory usage: 25%                IPv4 address for eth0:    10.0.2.15
  Swap usage:   0%                 IPv4 address for eth1:    192.168.56.11
  Processes:    118


This system is built by the Bento project by Chef Software
More information can be found at https://github.com/chef/bento
Last login: Fri Apr 22 14:13:55 2022 from 10.0.2.2
vagrant@server1:~$ docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
vagrant@server1:~$ 

```

---

Дополнительные материалы:

Установка [VirtualBox](https://www.virtualbox.org/wiki/Downloads)

Установка [Vagrant](https://www.vagrantup.com/downloads) *(потребуется VPN или [Cloudflare WARP](https://developers.cloudflare.com/warp-client/get-started/linux/))*

Установка [Ansible](https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html#installing-ansible-on-specific-operating-systems)
