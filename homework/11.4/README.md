# Домашнее задание по лекции "11.4 Микросервисы: масштабирование"

> Вы работаете в крупной компанию, которая строит систему на основе микросервисной архитектуры.
> Вам как DevOps специалисту необходимо выдвинуть предложение по организации инфраструктуры, для разработки и эксплуатации.

## Обязательная задача 1: Кластеризация

> Предложите решение для обеспечения развертывания, запуска и управления приложениями.
> Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.
> 
> Решение должно соответствовать следующим требованиям:
> - Поддержка контейнеров;
> - Обеспечивать обнаружение сервисов и маршрутизацию запросов;
> - Обеспечивать возможность горизонтального масштабирования;
> - Обеспечивать возможность автоматического масштабирования;
> - Обеспечивать явное разделение ресурсов доступных извне и внутри системы;
> - Обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п.
> 
> Обоснуйте свой выбор.

### Решение: кластеры Kubernetes

Обоснование:
- Стандартная рабочая единица кластера **Kubernetes** - **pod**, состоящий из одного или нескольких контейнеров;
- Кластер имеет отдельные компоненты как **services** и **endpoints**, позволяющие настраивать маршруты между **pods**, а при использовании сетевых модулей (например, **calico**), полностью абстрагироваться от физического расположения **pods** (например, физически они могут находиться в разных дата-центрах, но работать буд-то на одной локальной машине);
- Выбрав продвинутые сетевые модули можно применять сетевые политики, разграничивая сетевой доступ любым компонентам;;
- В **Kubernetes** может быть настроено горизонтальное масштабирование запущеных **pod**, путём изменения числа их реплик;
- К кластеру можно в рабочем режиме (без приостановки функционирования работающих машин) добавлять или удалять рабочие ноды;
- Есть возможность автоматического масштабирования
- **Kubernetes** предоставляет широкие возможности по конфигурированию контейнеров внутри **pods**, включая создание точек монтирования и передачу переменных окружения;
- Для каждого **pod** можно задать значения максимальной генерируемой нагрузки (потребление памяти, процессора);
- В кластере возможно использовать внешнее хранилище чувствительной информации, например **Hashicorp Vault**.

> Автоматическое масштабирование может быть реализовано созданием отдельного **pod**, имеющего доступ к метрикам нагрузки и управлению кластером.
> Например, при исчерпании свободных запасов мощностей разработанное ПО может разворачивать новые машины, добавлять их в кластер и увеличивать число реплик сервисов.
> При обнаружении снижения нагрузки - уменьшать число реплик сервисов и т.д. вплоть до выключения отдельных рабочих нод.
> Если на отключенных нодах были работающие сервисы они перераспределяться на оставшиеся ноды.

---

## Дополнительная задача 2: Распределенный кэш * (необязательная)

> Разработчикам вашей компании понадобился распределенный кэш для организации хранения временной информации по сессиям пользователей.
> Вам необходимо построить Redis Cluster состоящий из трех шард с тремя репликами.
>
> Схема:
>
> ![11-04-01](https://user-images.githubusercontent.com/1122523/114282923-9b16f900-9a4f-11eb-80aa-61ed09725760.png)

